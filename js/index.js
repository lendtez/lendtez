var LT;(()=>{"use strict";var e={};(e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})})(e);const t="KT1WGws1TV9QAG8uGuhCB4jw6en9E8FU8CN9",n="https://api.ghostnet.tzkt.io/v1/contracts/"+t,o=new beacon.DAppClient({name:"LendTez"});function a(e,t){let n=String(e),o=Number(t),a=n.indexOf(".");return a<0?n+"0".repeat(o):n.substring(0,a)+(n.length-a-1>=o?n.substring(a+1,a+1+o):n.substring(a+1)+"0".repeat(o-(n.length-a-1)))}let s="",i=new Map;async function l(e,t){let o=e?"&value.borrower."+(t?"eq":"ne")+"="+e:"";try{let e=await fetch(n+"/bigmaps/loans/keys?active=true&select=key,value"+o);if(e.ok){let t=await e.json();return console.log("INFO getLoans(): loans.size="+t.length+", loans="+JSON.stringify(t)),t}console.log("ERROR getLoans(): can't get loans")}catch(e){console.log("ERRROR getLoans(): "+JSON.stringify(e))}}const d="./img/tokens/",m={message:"Connect your wallet",type:"is-danger"},r={message:"The address is copied",type:"is-info"};function c(){let e=event.currentTarget.querySelector(".fas");event.currentTarget.parentElement.querySelector(".is-collapsible").classList.toggle("is-active"),e.classList.toggle("fa-angle-down"),e.classList.toggle("fa-angle-up")}async function g(e){await async function(e){let t=await o.getActiveAccount();if(t)s=t.address,console.log("INFO connect(): old userAddress="+s);else if(!e){let e=await o.requestPermissions({network:{type:"ghostnet"}});console.log("INFO connect(): got permissions=",e),s=e.address,console.log("INFO connect(): new userAddress="+s)}}(e),s&&(document.getElementById("divConnect").classList.add("is-hidden"),document.getElementById("aAddress").innerHTML=O(s),document.getElementById("divDisconnect").classList.remove("is-hidden"),document.getElementById("btnNewMyLoan").removeAttribute("disabled"))}function u(e){if(e){let t=e.innerHTML;t&&t.length>10&&(A(t),bulmaToast.toast(r))}else s&&(A(s),bulmaToast.toast(r))}async function y(){let e=document.getElementById("mdButton");e.classList.add("is-loading");let n=e.getAttribute("data-id");console.log("INFO doDeal(): id="+n);let a=i.get("dataTable");if(n&&a){let e=a.get(n);if(e){let a=await async function(e,n,a,l){let d=i.get("tokens").get(a);if(!d)return null;try{let a=[],i=0;s===n&&("0"===d.type?i=l:"1"===d.type?a.push({kind:beacon.TezosOperationType.TRANSACTION,amount:0,destination:d.address,parameters:{entrypoint:"approve",value:JSON.parse('{ "prim": "Pair", "args": [ { "string": "'+t+'" }, { "int": "'+l+'"    } ] }')}}):"2"===d.type&&a.push({kind:beacon.TezosOperationType.TRANSACTION,amount:0,destination:d.address,parameters:{entrypoint:"update_operators",value:JSON.parse('[ { "prim": "Left", "args": [ { "prim": "Pair", "args": [ { "string": "'+s+'" }, { "prim": "Pair", "args": [ { "string": "'+t+'" }, { "int": "'+d.token_id+'" } ] } ] } ] } ]')}})),a.push({kind:beacon.TezosOperationType.TRANSACTION,amount:i,destination:t,parameters:{entrypoint:"close_deal",value:JSON.parse('{ "int": "'+e+'" }')}});let m=await o.requestOperation({operationDetails:a});if(console.log("INFO closeDeal(): result="+JSON.stringify(m)),m.transactionHash)return m.transactionHash}catch(e){console.log("ERRROR closeDeal(): "+JSON.stringify(e))}}(n,e.borrower,e.loan_token_id,Number(e.loan_amount)+Number(e.reward));a&&(h(a),document.getElementById("mydeal"+n).remove())}else console.log("ERROR doDeal(): there is no deal value for id="+n)}else console.log("ERROR doDeal(): there is no deal id or data");document.getElementById("modalDeal").classList.remove("is-active"),e.classList.remove("is-loading")}function p(e){let t=i.get("tokens");if("loan"===e){let e=document.getElementById("mmlLoanToken").value;e&&e>=0?(document.getElementById("mmlLoanTokenImage").setAttribute("src",d+t.get(e).name+".png"),document.getElementById("mmlRewardTokenImage").setAttribute("src",d+t.get(e).name+".png"),"XTZ"===t.get(e).name?document.getElementById("mmlLoanTokenAddress").innerHTML="&nbsp;":document.getElementById("mmlLoanTokenAddress").innerHTML=t.get(e).address):(document.getElementById("mmlLoanTokenImage").setAttribute("src",""),document.getElementById("mmlRewardTokenImage").setAttribute("src",""),document.getElementById("mmlLoanTokenAddress").innerHTML="&nbsp;")}else if("deposit"===e){let e=document.getElementById("mmlDepositToken").value;e&&e>=0?(document.getElementById("mmlDepositTokenImage").setAttribute("src",d+t.get(e).name+".png"),"XTZ"===t.get(e).name?document.getElementById("mmlDepositTokenAddress").innerHTML="&nbsp;":document.getElementById("mmlDepositTokenAddress").innerHTML=t.get(e).address):(document.getElementById("mmlDepositTokenImage").setAttribute("src",""),document.getElementById("mmlDepositTokenAddress").innerHTML="&nbsp;")}}function L(){let e=document.getElementById("mmlLoanAmount").value,t=document.getElementById("mmlRewardAmount").value,n=document.getElementById("mmlTime").value;isNaN(e)||isNaN(parseFloat(e))||isNaN(t)||isNaN(parseFloat(t))||isNaN(n)||isNaN(parseFloat(n))?document.getElementById("mmlAPR").innerHTML="-":document.getElementById("mmlAPR").innerHTML=(100*t*365/n/e).toFixed(2)}async function T(){R(),B(),document.getElementById("contentLoans").classList.remove("is-hidden");let e=document.getElementById("tblLoans");e.innerHTML="";let t=new Map;i.set("dataTable",t);let n=await l(s,!1);if(n.length>0){let o,a,l,m,r,c=i.get("tokens"),g="";for(let e=0;e<n.length;e++)o=n[e].key,a=n[e].value,a.borrower!==s&&(l=c.get(a.loan_token_id),m=c.get(a.deposit_token_id),r=Math.ceil(a.time/86400),t.set(o,a),g+='<tr id="loan'+o+'" data-id="'+o+'" class="is-clickable"><td><figure class="image is-24x24 mr-1 is-pulled-left"><img src="'+d+l.name+'.png"></figure><span class="has-text-weight-semibold">'+l.name+"</span></td><td>"+v(a.loan_amount,l)+"</td><td>"+v(a.reward,l)+"</td><td>"+r+(1===r?" day":" days")+'</td><td><figure class="image is-24x24 mr-1 is-pulled-left"><img src="'+d+m.name+'.png"></figure><span class="has-text-weight-semibold">'+m.name+"</span>&nbsp;"+v(a.deposit_amount,m)+"</td></tr>");e.innerHTML=g}}async function E(e){if(!s)return void bulmaToast.toast(m);let t=event.target.closest("tr");if(!t)return void console.log("ERROR showLoan(): there is no TR element");let n=t.getAttribute("data-id");if(console.log("INFO showLoan(): id="+n),console.log("INFO showLoan(): action="+e),"cancelLoan"!==e&&"makeDeal"!==e)return void console.log("ERROR showLoan(): invalid action");let o=i.get("dataTable");if(n&&o){let t=o.get(n);if(t){let o=i.get("tokens").get(t.loan_token_id),a=i.get("tokens").get(t.deposit_token_id),l=Math.ceil(t.time/86400);document.getElementById("mlLoanTokenImg").setAttribute("src",d+o.name+".png"),document.getElementById("mlLoanTokenName").innerHTML=o.name,document.getElementById("mlLoanAmount").innerHTML=k(t.loan_amount,o),document.getElementById("mlRewardTokenImg").setAttribute("src",d+o.name+".png"),document.getElementById("mlRewardTokenName").innerHTML=o.name,document.getElementById("mlRewardAmount").innerHTML=k(t.reward,o),document.getElementById("mlTime").innerHTML=l+"&nbsp;"+(1===l?"day":"days"),document.getElementById("mlValidity").innerHTML=I(t.validity),document.getElementById("mlDepositTokenImg").setAttribute("src",d+a.name+".png"),document.getElementById("mlDepositTokenName").innerHTML=a.name,document.getElementById("mlDepositAmount").innerHTML=k(t.deposit_amount,a);let m=document.getElementById("mlTitle"),r=document.getElementById("mlButton");r.setAttribute("data-id",n),r.removeEventListener("click",b),r.removeEventListener("click",f),r.classList.remove("is-loading"),r.removeAttribute("disabled"),"cancelLoan"===e?(m.innerHTML="My loan request",r.innerHTML="Cancel request",r.addEventListener("click",b)):"makeDeal"===e&&(m.innerHTML="Loan request",r.innerHTML="Lend",s===t.borrower?r.setAttribute("disabled",""):r.addEventListener("click",f)),document.getElementById("modalLoan").classList.add("is-active")}else console.log("ERROR showLoan(): there is no loan value for id="+n)}else console.log("ERROR showLoan(): there is no loan id or data for action="+e)}async function b(){let e=document.getElementById("mlButton"),n=e.getAttribute("data-id");if(console.log("INFO doCancelLoan(): id="+n),n){e.classList.add("is-loading");let a=await async function(e){try{let n=await o.requestOperation({operationDetails:[{kind:beacon.TezosOperationType.TRANSACTION,amount:0,destination:t,parameters:{entrypoint:"cancel_loan",value:JSON.parse('{ "int": "'+e+'" }')}}]});if(console.log("INFO cancelLoan(): result="+JSON.stringify(n)),n.transactionHash)return n.transactionHash}catch(e){console.log("ERRROR cancelLoan(): "+JSON.stringify(e))}}(n);a&&(h(a),document.getElementById("myloan"+n).remove())}else console.log("ERROR doCancelLoan(): there is no loan id");document.getElementById("modalLoan").classList.remove("is-active"),e.classList.remove("is-loading")}async function f(){if(!s)return void bulmaToast.toast(m);let e=document.getElementById("mlButton");e.classList.add("is-loading");let n=e.getAttribute("data-id");console.log("INFO doMakeDeal(): id="+n);let a=i.get("dataTable");if(n&&a){let e=a.get(n);if(e){let a=await async function(e,n,a){let l=i.get("tokens").get(n);if(!l)return null;try{let n=[],i=0;"0"===l.type?i=a:"1"===l.type?n.push({kind:beacon.TezosOperationType.TRANSACTION,amount:0,destination:l.address,parameters:{entrypoint:"approve",value:JSON.parse('{ "prim": "Pair", "args": [ { "string": "'+t+'" }, { "int": "'+a+'"    } ] }')}}):"2"===l.type&&n.push({kind:beacon.TezosOperationType.TRANSACTION,amount:0,destination:l.address,parameters:{entrypoint:"update_operators",value:JSON.parse('[ { "prim": "Left", "args": [ { "prim": "Pair", "args": [ { "string": "'+s+'" }, { "prim": "Pair", "args": [ { "string": "'+t+'" }, { "int": "'+l.token_id+'" } ] } ] } ] } ]')}}),n.push({kind:beacon.TezosOperationType.TRANSACTION,amount:i,destination:t,parameters:{entrypoint:"make_deal",value:JSON.parse('{ "int": "'+e+'" }')}});let d=await o.requestOperation({operationDetails:n});if(console.log("INFO makeDeal(): result="+JSON.stringify(d)),d.transactionHash)return d.transactionHash}catch(e){console.log("ERRROR makeDeal(): "+JSON.stringify(e))}}(n,e.loan_token_id,e.loan_amount);a&&(h(a),document.getElementById("loan"+n).remove())}else console.log("ERROR doMakeDeal(): there is no loan value for id="+n)}else console.log("ERROR doMakeDeal(): there is no loan id or data");document.getElementById("modalLoan").classList.remove("is-active"),e.classList.remove("is-loading")}function I(e){return e?new Date(Date.parse(e)).toLocaleString():"&infin;"}function k(e,t){return t?e/10**t.decimals:e}function v(e,t){return t?Math.round(e/10**(t.decimals-4))/1e4:e}function h(e){bulmaToast.toast({message:"Your request is processing with ID <a href='https://ghostnet.tzkt.io/"+e+"' target='_blank'>"+O(e)+"</a>",duration:7e3,type:"is-info"})}function R(){document.getElementById("btnBurger").classList.remove("is-active"),document.getElementById("navbarMenu").classList.remove("is-active")}function B(){document.getElementById("contentMyDeals").classList.add("is-hidden"),document.getElementById("contentMyLoans").classList.add("is-hidden"),document.getElementById("contentLoans").classList.add("is-hidden"),document.getElementById("contentInfo").classList.add("is-hidden")}function O(e){return e&&e.length>14?e.substring(0,7)+"..."+e.substring(e.length-4):e}function A(e){if(navigator.clipboard)navigator.clipboard.writeText(e).then((function(){}),(function(e){console.log("ERROR copyToClipboard(): "+e)}));else{var t=document.createElement("textarea");t.value=e,t.style.top="0",t.style.left="0",t.style.position="fixed",document.body.appendChild(t),t.focus(),t.select();try{document.execCommand("copy")}catch(e){console.log("ERROR copyToClipboard(): "+e)}document.body.removeChild(t)}}bulmaToast.setDefaults({duration:5e3,position:"bottom-left",dismissible:!0,animate:{in:"zoomIn",out:"zoomOut"}}),document.addEventListener("DOMContentLoaded",(async function(){await async function(){try{let e=await fetch(n+"/storage?path=time");if(e.ok){let t=await e.json();console.log("INFO loadStorageData(): time="+JSON.stringify(t)),i.set("time",t)}else console.log("ERROR loadStorageData(): can't get time")}catch(e){console.log("ERRROR loadStorageData(): "+JSON.stringify(e))}try{let e=await fetch(n+"/bigmaps/tokens/keys?active=true&select=key,value");if(e.ok){let t=await e.json();console.log("INFO loadStorageData(): tokens="+JSON.stringify(t));let n=new Map;if(t&&t.length>0)for(let e=0;e<t.length;e++)n.set(t[e].key,t[e].value);i.set("tokens",n)}else console.log("ERROR loadStorageData(): can't get tokens")}catch(e){console.log("ERRROR loadStorageData(): "+e)}}();let e=i.get("tokens"),t='<option value="" selected="">[select token]</option>';if(e)for(let n of e.keys())e.get(n).active&&(t+='<option value="'+n+'">'+e.get(n).name+"</option>");document.getElementById("mmlLoanToken").innerHTML=t,document.getElementById("mmlDepositToken").innerHTML=t,T(),g(!0)})),document.getElementById("btnMyDeals").addEventListener("click",(()=>async function(){R(),B();let e=document.getElementById("tblMyDeals");e.innerHTML="",document.getElementById("contentMyDeals").classList.remove("is-hidden");let t=new Map;if(i.set("dataTable",t),!s)return void bulmaToast.toast(m);let o=await async function(){try{let e=await fetch(n+"/bigmaps/deals/keys?active=true&select=key,value");if(e.ok){let t=await e.json();return console.log("INFO getDeals(): deals="+JSON.stringify(t)),t}console.log("ERROR getDeals(): can't get deals")}catch(e){console.log("ERRROR getDeals(): "+JSON.stringify(e))}}();if(o.length>0){let n,a,l,m,r,c,g,u,y=i.get("tokens"),p="";for(let e=0;e<o.length;e++)l=o[e].key,m=o[e].value,n=y.get(m.loan_token_id),a=y.get(m.deposit_token_id),r=m.borrower===s,c=m.creditor===s,g=Math.ceil((Date.parse(m.exp)-Date.now())/864e5),u=r||c&&g<=0,(r||c)&&(t.set(l,m),p+='<tr id="mydeal'+l+'" data-id="'+l+'" class="is-clickable'+(g<0?" has-background-danger-light":"")+'"><td class="is-clickable"><span class="icon"><i class="fas fa-hand-holding-dollar"'+(c?' style="transform: rotate(180deg)':"")+'"></i></span></td><td><figure class="image is-24x24 mr-1 is-pulled-left"><img src="'+d+n.name+'.png"></figure><span class="has-text-weight-semibold">'+n.name+"</span></td><td>"+v(m.loan_amount,n)+"</td><td>"+v(m.reward,n)+"</td><td>"+g+(1===g?" day":" days")+'</td><td><figure class="image is-24x24 mr-1 is-pulled-left"><img src="'+d+a.name+'.png"></figure><span class="has-text-weight-semibold">'+a.name+"</span>&nbsp;"+v(m.deposit_amount,a)+"</td></tr>");e.innerHTML=p}}())),document.getElementById("btnMyLoans").addEventListener("click",(()=>async function(){R(),B();let e=document.getElementById("tblMyLoans");e.innerHTML="",document.getElementById("contentMyLoans").classList.remove("is-hidden");let t=new Map;if(i.set("dataTable",t),!s)return void bulmaToast.toast(m);let n=await l(s,!0);if(n.length>0){let o,a,s,l,m,r=i.get("tokens"),c="";for(let e=0;e<n.length;e++)o=n[e].key,a=n[e].value,s=r.get(a.loan_token_id),l=r.get(a.deposit_token_id),m=Math.ceil(a.time/86400),t.set(o,a),c+='<tr id="myloan'+o+'" data-id="'+o+'" class="is-clickable"><td><figure class="image is-24x24 mr-1 is-pulled-left"><img src="'+d+s.name+'.png"></figure><span class="has-text-weight-semibold">'+s.name+"</span></td><td>"+v(a.loan_amount,s)+"</td><td>"+v(a.reward,s)+"</td><td>"+m+(1===m?" day":" days")+'</td><td><figure class="image is-24x24 mr-1 is-pulled-left"><img src="'+d+l.name+'.png"></figure><span class="has-text-weight-semibold">'+l.name+"</span>&nbsp;"+v(a.deposit_amount,l)+"</td><td>"+I(a.validity)+"</td></tr>";e.innerHTML=c}}())),document.getElementById("btnLoans").addEventListener("click",(()=>T())),document.getElementById("btnInfo").addEventListener("click",(()=>(R(),B(),void document.getElementById("contentInfo").classList.remove("is-hidden")))),document.getElementById("btnConnect").addEventListener("click",(()=>g(!1))),document.getElementById("btnCopyAddress").addEventListener("click",(()=>u())),document.getElementById("btnDisconnect").addEventListener("click",(()=>async function(){await async function(){await o.removeAllAccounts(),s=""}(),s||(document.getElementById("divDisconnect").classList.add("is-hidden"),document.getElementById("aAddress").innerHTML="",document.getElementById("divConnect").classList.remove("is-hidden"),document.getElementById("btnNewMyLoan").setAttribute("disabled",""),T())}())),document.getElementById("tblMyDeals").addEventListener("click",(()=>async function(){let e=event.target.closest("tr");if(!e)return void console.log("ERROR showDeal(): there is no TR element");let t=e.getAttribute("data-id");console.log("INFO showDeal(): id="+t);let n=i.get("dataTable");if(t&&n){let e=n.get(t);if(e){let n=i.get("tokens").get(e.loan_token_id),o=i.get("tokens").get(e.deposit_token_id),a=e.borrower===s,l=(Date.parse(e.exp)-Date.now())/864e5;document.getElementById("mdLoanTokenImg").setAttribute("src",d+n.name+".png"),document.getElementById("mdLoanTokenName").innerHTML=n.name,document.getElementById("mdLoanAmount").innerHTML=k(e.loan_amount,n),document.getElementById("mdRewardTokenImg").setAttribute("src",d+n.name+".png"),document.getElementById("mdRewardTokenName").innerHTML=n.name,document.getElementById("mdRewardAmount").innerHTML=k(e.reward,n);let m=document.getElementById("mdTime");m.innerHTML=Math.ceil(l)+"&nbsp;"+(1===Math.abs(Math.ceil(l))?"day":"days"),l<0?m.classList.add("has-text-danger"):m.classList.remove("has-text-danger"),document.getElementById("mdDepositTokenImg").setAttribute("src",d+o.name+".png"),document.getElementById("mdDepositTokenName").innerHTML=o.name,document.getElementById("mdDepositAmount").innerHTML=k(e.deposit_amount,o);let r=document.getElementById("mdTitle"),c=document.getElementById("mdButton");c.setAttribute("data-id",t),c.removeEventListener("click",y),c.classList.remove("is-loading"),c.removeAttribute("disabled"),a?(document.getElementById("mdSumTokenImg").setAttribute("src",d+n.name+".png"),document.getElementById("mdSumTokenName").innerHTML=n.name,document.getElementById("mdSumAmount").innerHTML=k(Number(e.loan_amount)+Number(e.reward),n),r.innerHTML="Repay",c.innerHTML="Repay",c.addEventListener("click",y)):(document.getElementById("mdSumTokenImg").setAttribute("src",d+o.name+".png"),document.getElementById("mdSumTokenName").innerHTML=o.name,document.getElementById("mdSumAmount").innerHTML=k(Number(e.deposit_amount),o),r.innerHTML="Withdrawal",c.innerHTML="Take it",l<=0?c.addEventListener("click",y):c.setAttribute("disabled","")),document.getElementById("modalDeal").classList.add("is-active")}else console.log("ERROR showDeal(): there is no deal value for id="+t)}else console.log("ERROR showDeal(): there is no deal id or data")}())),document.getElementById("tblMyLoans").addEventListener("click",(()=>E("cancelLoan"))),document.getElementById("tblLoans").addEventListener("click",(()=>E("makeDeal"))),document.getElementById("btnNewMyLoan").addEventListener("click",(()=>async function(){s?document.getElementById("modalMyLoan").classList.add("is-active"):bulmaToast.toast(m)}())),document.getElementById("mmlLoanToken").addEventListener("change",(()=>p("loan"))),document.getElementById("mmlDepositToken").addEventListener("change",(()=>p("deposit"))),document.querySelectorAll(".js-calc-apr").forEach((function(e){e.onchange=L})),document.getElementById("mmlLoanTokenAddress").addEventListener("click",(()=>u(event.currentTarget))),document.getElementById("mmlDepositTokenAddress").addEventListener("click",(()=>u(event.currentTarget))),document.getElementById("mmlButton").addEventListener("click",(()=>async function(){let e=document.getElementById("mmlButton");e.classList.add("is-loading");let n=document.getElementById("mmlLoanToken").value,l=document.getElementById("mmlLoanAmount").value,d=document.getElementById("mmlRewardAmount").value,m=document.getElementById("mmlTime").value,r=document.getElementById("mmlDepositToken").value,c=document.getElementById("mmlDepositAmount").value,g=document.getElementById("mmlValidity").value;console.log("---\n"),console.log("loanTokenId="+n),console.log("loanAmount="+l),console.log("rewardAmount="+d),console.log("time="+m),console.log("depositTokenId="+r),console.log("depositAmount="+c),console.log("validity="+g),console.log("---\n");let u=i.get("tokens"),y=!1;u.get(n)||(console.log("ERROR doAddLoan(): loan token has to be selected"),bulmaToast.toast({message:"Select <b>loan asset</b>",type:"is-danger"}),y=!0),l&&l>0||(console.log("ERROR doAddLoan(): loan amount has to be a number in (0, inf)"),bulmaToast.toast({message:"Enter <b>loan amount</b> in (0, inf)",type:"is-danger"}),y=!0),d&&d>=0||(console.log("ERROR doAddLoan(): reward amount has to be a number in [0, inf)"),bulmaToast.toast({message:"Enter <b>reward amount</b> in [0, inf)",type:"is-danger"}),y=!0);let p=86400;if(m=Math.floor(m*p),m&&m>=i.get("time").min&&m<=i.get("time").max||(console.log("ERROR doAddLoan(): time has to be in ["+i.get("time").min/p+", "+i.get("time").max/p+"] days"),bulmaToast.toast({message:"Loan term has to be in ["+i.get("time").min/p+", "+i.get("time").max/p+"] days",type:"is-danger"}),y=!0),u.get(r)||(console.log("ERROR doAddLoan(): deposit token has to be selected"),bulmaToast.toast({message:"Select <b>collateral asset</b>",type:"is-danger"}),y=!0),n&&n===r&&(console.log("ERROR doAddLoan(): loan and deposit tokens have to be different"),bulmaToast.toast({message:"<b>Loan</b> and <b>collateral assets</b> have to be different",type:"is-danger"}),y=!0),c&&c>=0||(console.log("ERROR doAddLoan(): deposit amount has to be a number in [0, inf)"),bulmaToast.toast({message:"Enter <b>collateral amount</b> in [0, inf)",type:"is-danger"}),y=!0),g&&Math.floor(new Date(g).getTime()/6e4)<=Math.floor(Date.now()/6e4)&&(console.log("ERROR doAddLoan(): validity has to be later than the current moment"),bulmaToast.toast({message:"<b>Validity</b> has to be later than the current moment",type:"is-danger"}),y=!0),!y){let e=await async function(e,n,l,d,m,r,c){let g=i.get("tokens").get(e),u=i.get("tokens").get(m);if(n=a(n,g.decimals),l=a(l,g.decimals),r=a(r,u.decimals),d>=i.get("time").min&&d<=i.get("time").max){if(c){if(Math.floor(new Date(c).getTime()/6e4)<=Math.floor(Date.now()/6e4))return;c='"Some", "args": [ { "string": "'+new Date(c).toJSON()+'" } ]'}else c='"None"';try{let a=[],i=0;"0"===u.type?i=r:"1"===u.type?a.push({kind:beacon.TezosOperationType.TRANSACTION,amount:0,destination:u.address,parameters:{entrypoint:"approve",value:JSON.parse('{ "prim": "Pair", "args": [ { "string": "'+t+'" }, { "int": "'+r+'"    } ] }')}}):"2"===u.type&&a.push({kind:beacon.TezosOperationType.TRANSACTION,amount:0,destination:u.address,parameters:{entrypoint:"update_operators",value:JSON.parse('[ { "prim": "Left", "args": [ { "prim": "Pair", "args": [ { "string": "'+s+'" }, { "prim": "Pair", "args": [ { "string": "'+t+'" }, { "int": "'+u.token_id+'" } ] } ] } ] } ]')}}),a.push({kind:beacon.TezosOperationType.TRANSACTION,amount:i,destination:t,parameters:{entrypoint:"add_loan",value:JSON.parse('{ "prim": "Pair", "args": [ { "prim": "Pair", "args": [ { "int": "'+r+'" }, { "prim": "Pair", "args": [ { "int": "'+m+'" }, { "int": "'+n+'" } ] } ] }, { "prim": "Pair", "args": [ { "prim": "Pair", "args": [ { "int": "'+e+'" }, { "int": "'+l+'" } ] }, { "prim": "Pair", "args": [ { "int": "'+d+'" }, { "prim": '+c+" } ] } ] } ] }")}});let g=await o.requestOperation({operationDetails:a});if(console.log("INFO addLoan(): result="+JSON.stringify(g)),g.transactionHash)return g.transactionHash}catch(e){console.log("ERRROR addLoan(): "+e)}}}(n,l,d,m,r,c,g);e&&(h(e),document.getElementById("modalMyLoan").classList.remove("is-active"))}e.classList.remove("is-loading")}())),document.querySelectorAll(".js-faq-item").forEach((function(e){e.onclick=c})),LT=e})();